from Crypto.Util.number import long_to_bytes
import gmpy2
import libnum

e = 65537
n = 20808904293513081190845780750070105618616969361906080805975757175282832326814292385288010321890720636985517966996434979361428446689142022057924775533413382276941240692485723190323428937113542816092202781921212596032285293494565651913203964086764437997598589753415006546131773075620639662424931922332580002911369614353522628697308086678801998556107085884006753004521292782307106042872607140567400461537551197503882678679563105251817106064455405691970657603271596345044915766971415752170264153045121209544168365725825851173643948865386575422222994944663481452567489984081894706792917980675554894607966117659033979788479
dp = 141781229812137954292042744172632776218945007606732989352082767387959833612477249905842979563263767675375965078342982849858729509939655868491642962206602907080533794760646446254011961577087507846915803022292269102806117763992707769490027943611119075538003462867728041700990051317509017154290418373667837613321
c = 1190205758661381779702638780076482181071644401777401016870652017535123017519761586569445518159681913527343108095994038739667374181434523342536730053956873845172375285244269078056015604402214259152787084398553033823863924958510530097626605227208914253315565933475070764640648569489298198795882885729570027997408779548778698954797677852252513392374379194623553865744439179271488590270374046627747098292321739675081901999705841565593931705605112975113573099803720092165781685744077293231488467822584099353957622926344392484545976447072995522813253863566344862006075503694751330216072820239155717042350553786280966528088

for i in range(1, 65538):
    if (dp * e - 1) % i == 0:
        if n % (((dp * e - 1) // i) + 1) == 0:
            p = ((dp * e - 1) // i) + 1
            q = n // (((dp * e - 1) // i) + 1)
            phi = (p - 1) * (q - 1)
            d = gmpy2.invert(e, phi) % phi
            print("d=", d)
            print("m=",pow(c, d, n))
            print("m_bytetype=",long_to_bytes(pow(c, d, n)))
